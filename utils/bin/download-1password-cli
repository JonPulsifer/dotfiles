#!/usr/bin/env bash
download-1password-cli() {
  local OS=linux
  local dir=$(pwd)

  # usage
  [[ -z "$1" ]] && { echo "usage: download-1password-cli <version>" >&2; return 1; }

  # switch out for macOS if we have to
  [ `uname -s` == "Darwin" ] && { OS=darwin; }

  wget -O /tmp/op.zip https://cache.agilebits.com/dist/1P/op/pkg/v"${1}"/op_"${OS}"_amd64_v"${1}".zip
  unzip /tmp/op.zip -d /tmp
  rm -v /tmp/op.zip
  add_gpg_key 3FEF9748469ADBE15DA7CA80AC2D62742012EA22
  gpg --verify /tmp/op.sig /tmp/op
  rm -v /tmp/op.sig
  mv -v /tmp/op ${dir}
}

download-1password-cli "$@"
